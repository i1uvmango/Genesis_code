# Car URDF 분석 문서

## 개요

이 문서는 `car.urdf` 파일에 대한 상세 분석입니다. 이 URDF는 조향(steering) 및 서스펜션(suspension) 시스템을 가진 자동차 로봇 모델을 정의합니다.

**로봇 이름**: `car_with_steering_suspension`

---

## 전체 구조도

```
car_body (차체 - 루트)
│
├── susp_fl (서스펜션 앞왼쪽 - fixed)
│   └── steer_fl_link (조향 링크 앞왼쪽 - revolute)
│       └── wheel_fl (바퀴 앞왼쪽 - continuous 회전)
│
├── susp_fr (서스펜션 앞오른쪽 - fixed)
│   └── steer_fr_link (조향 링크 앞오른쪽 - revolute)
│       └── wheel_fr (바퀴 앞오른쪽 - continuous 회전)
│
├── susp_rl (서스펜션 뒤왼쪽 - fixed)
│   └── wheel_rl (바퀴 뒤왼쪽 - continuous 회전)
│
└── susp_rr (서스펜션 뒤오른쪽 - fixed)
    └── wheel_rr (바퀴 뒤오른쪽 - continuous 회전)
```

### 조인트 타입 요약
- **fixed**: 고정 조인트 (4개 - 서스펜션 연결)
- **revolute**: 회전 조인트 (2개 - 앞바퀴 조향)
- **continuous**: 연속 회전 조인트 (4개 - 바퀴 회전)

---

## 링크 상세 정보

### 1. 차체 (car_body) - 루트 링크

**질량 및 관성**:
- 질량: `1200.0 kg`
- 관성 행렬:
  - `ixx = 400`
  - `iyy = 800`
  - `izz = 400`
  - `ixy = ixz = iyz = 0` (대각 행렬)

**무게중심**: 링크 원점 `(0, 0, 0)` (명시적 `<origin>` 없음)

**기하학**:
- 충돌/시각: 박스 `2.5m × 1.2m × 0.5m` (길이 × 폭 × 높이)

---

### 2. 바퀴 링크 (4개)

#### wheel_fl (앞왼쪽), wheel_fr (앞오른쪽)
#### wheel_rl (뒤왼쪽), wheel_rr (뒤오른쪽)

**질량 및 관성** (모든 바퀴 동일):
- 질량: `20.0 kg`
- 관성 행렬:
  - `ixx = 0.5`
  - `iyy = 1.0`
  - `izz = 0.5`
  - `ixy = ixz = iyz = 0`

**무게중심**: 링크 원점 `(0, 0, 0)`

**기하학**:
- 충돌/시각: 실린더
  - 반지름: `0.35 m`
  - 길이: `0.2 m`
  - 회전: `rpy="1.5708 0 0"` (90도 회전, X축 기준)

---

### 3. 서스펜션 링크 (4개)

#### susp_fl, susp_fr, susp_rl, susp_rr

**질량 및 관성** (모든 서스펜션 동일):
- 질량: `1.0 kg` (최소 질량)
- 관성 행렬:
  - `ixx = iyy = izz = 0.01`
  - `ixy = ixz = iyz = 0`

**무게중심**: 링크 원점 `(0, 0, 0)`

**기하학**: 없음 (보이지 않는 연결 링크)

---

### 4. 조향 링크 (2개, 앞바퀴용만)

#### steer_fl_link, steer_fr_link

**질량 및 관성**:
- 질량: `0.5 kg`
- 관성 행렬:
  - `ixx = iyy = izz = 0.01`
  - `ixy = ixz = iyz = 0`

**무게중심**: 링크 원점 `(0, 0, 0)`

**기하학**: 없음 (조향 회전축 역할)

---

## 조인트 상세 정보

### 앞바퀴 시스템 (2개)

#### 1. 앞왼쪽 (Front Left)

**susp_fl_joint** (fixed):
- Parent: `car_body`
- Child: `susp_fl`
- 위치: `xyz="1.2 -0.6 -0.25"`
- 설명: 차체에서 앞왼쪽 서스펜션으로 고정 연결

**steer_fl** (revolute):
- Parent: `susp_fl`
- Child: `steer_fl_link`
- 위치: `xyz="0 0 -0.35"` (서스펜션 기준 아래 0.35m)
- 회전축: `axis="0 0 1"` (Z축, 수직)
- 제한:
  - `lower="-0.6"` ~ `upper="0.6"` (약 ±34도)
  - `effort="500"` (최대 토크)
  - `velocity="2"` (최대 각속도 rad/s)

**wheel_fl_rotate** (continuous):
- Parent: `steer_fl_link`
- Child: `wheel_fl`
- 위치: `xyz="0 0 0"` (조향 링크와 동일 위치)
- 회전축: `axis="0 1 0"` (Y축, 수평)
- 제한: 없음 (연속 회전 가능)

#### 2. 앞오른쪽 (Front Right)

**susp_fr_joint** (fixed):
- Parent: `car_body`
- Child: `susp_fr`
- 위치: `xyz="1.2 0.6 -0.25"`

**steer_fr** (revolute):
- Parent: `susp_fr`
- Child: `steer_fr_link`
- 위치: `xyz="0 0 -0.35"`
- 회전축: `axis="0 0 1"`
- 제한: 앞왼쪽과 동일

**wheel_fr_rotate** (continuous):
- Parent: `steer_fr_link`
- Child: `wheel_fr`
- 위치: `xyz="0 0 0"`
- 회전축: `axis="0 1 0"`

---

### 뒤바퀴 시스템 (2개)

#### 3. 뒤왼쪽 (Rear Left)

**susp_rl_joint** (fixed):
- Parent: `car_body`
- Child: `susp_rl`
- 위치: `xyz="-1.2 -0.6 -0.25"`

**rear_rl** (continuous):
- Parent: `susp_rl`
- Child: `wheel_rl`
- 위치: `xyz="0 0 -0.35"` (서스펜션 기준 아래 0.35m)
- 회전축: `axis="0 1 0"` (Y축, 수평)
- 제한: 없음 (연속 회전 가능)

#### 4. 뒤오른쪽 (Rear Right)

**susp_rr_joint** (fixed):
- Parent: `car_body`
- Child: `susp_rr`
- 위치: `xyz="-1.2 0.6 -0.25"`

**rear_rr** (continuous):
- Parent: `susp_rr`
- Child: `wheel_rr`
- 위치: `xyz="0 0 -0.35"`
- 회전축: `axis="0 1 0"`

---

## 좌표계 및 위치 정보

### 차체 중심 기준 좌표계
- **원점**: `(0, 0, 0)` = 차체 중심
- **X축**: 전진 방향 (+X = 앞)
- **Y축**: 좌우 방향 (+Y = 왼쪽, -Y = 오른쪽)
- **Z축**: 상하 방향 (+Z = 위, -Z = 아래)

### 바퀴 위치 (차체 기준)
- **앞왼쪽**: `(1.2, -0.6, -0.25)` → 서스펜션 연결점
- **앞오른쪽**: `(1.2, 0.6, -0.25)` → 서스펜션 연결점
- **뒤왼쪽**: `(-1.2, -0.6, -0.25)` → 서스펜션 연결점
- **뒤오른쪽**: `(-1.2, 0.6, -0.25)` → 서스펜션 연결점

### 바퀴 실제 위치
- 서스펜션에서 `z=-0.35`만큼 아래에 바퀴 중심이 위치
- 최종 바퀴 중심 Z 좌표: 약 `-0.6` (차체 중심 기준)

### 차체 치수
- 길이: `2.5 m` (X축)
- 폭: `1.2 m` (Y축)
- 높이: `0.5 m` (Z축)
- 차체 하단 Z 좌표: `-0.25` (중심 기준)

---

## 무게중심 및 관성 정보

### 무게중심 처리
**현재 모든 링크는 무게중심이 링크 원점 `(0, 0, 0)`에 위치합니다.**

URDF에서 무게중심은 `<inertial>` 태그 내의 `<origin>` 요소로 정의되지만, 현재 URDF에는 명시적인 `<origin>`이 없으므로 기본값인 링크 원점이 사용됩니다.

### 전체 시스템 질량
- 차체: `1200.0 kg`
- 바퀴 4개: `20.0 kg × 4 = 80.0 kg`
- 서스펜션 4개: `1.0 kg × 4 = 4.0 kg`
- 조향 링크 2개: `0.5 kg × 2 = 1.0 kg`
- **총 질량**: 약 `1285.0 kg`

### 관성 특성
- 차체는 Y축(폭 방향) 관성이 가장 큼 (`iyy=800`)
- 바퀴는 Y축(회전축) 관성이 가장 큼 (`iyy=1.0`)

---

## 시스템 설계 특징

### 1. 조향과 회전의 분리
- 앞바퀴는 **조향**과 **회전**이 별도의 조인트로 분리됨
  - `steer_*`: 조향 (Z축 회전, revolute)
  - `wheel_*_rotate`: 바퀴 회전 (Y축 회전, continuous)

### 2. 서스펜션 구조
- 서스펜션은 `fixed` 조인트로 차체에 고정
- 실제 서스펜션 동작은 시뮬레이션에서 별도로 구현될 수 있음

### 3. 뒤바퀴 단순화
- 뒤바퀴는 조향 링크 없이 직접 회전만 가능
- 앞바퀴만 조향 가능한 전형적인 자동차 구조

### 4. 좌표계 규칙
- 표준 로봇 좌표계 사용
- 바퀴 회전축이 Y축 (수평)인 것은 X축 전진 시 바퀴가 회전하도록 설계됨

---

## DOF (자유도) 요약

### 제어 가능한 DOF
1. **조향 DOF** (2개):
   - `steer_fl` (앞왼쪽 조향)
   - `steer_fr` (앞오른쪽 조향)
   - 각각 ±0.6 rad (±34도) 범위

2. **구동 DOF** (4개):
   - `wheel_fl_rotate` (앞왼쪽 회전)
   - `wheel_fr_rotate` (앞오른쪽 회전)
   - `rear_rl` (뒤왼쪽 회전)
   - `rear_rr` (뒤오른쪽 회전)
   - 각각 무제한 연속 회전 가능

**총 제어 DOF**: 6개

---

## 사용 예시

이 URDF 모델은 다음을 위해 설계되었습니다:
- 자율 주행 시뮬레이션
- 물리 기반 강화 학습
- 자동차 동역학 연구
- 조향 및 구동 제어 테스트

---

## 참고사항

1. **무게중심 조정**: 실제 차량의 무게중심을 반영하려면 각 링크의 `<inertial>` 태그 내에 `<origin>` 요소를 추가할 수 있습니다.
2. **서스펜션 동작**: 현재는 `fixed`이지만, 필요시 `prismatic` 또는 `revolute` 조인트로 변경하여 동적 서스펜션 구현 가능합니다.
3. **물리 파라미터**: 질량, 관성, 조인트 제한 값들은 실제 차량 데이터에 맞게 조정 가능합니다.

